<div class="edit-container">

  <!-- En-tête avec photo et documents -->
  <mat-card class="profile-card">
    <mat-card-title>Informations de profil</mat-card-title>
    <mat-card-content>
      <div class="profile-header">

        <!-- Photo -->
        <div class="photo-section">
          <label>
            <div class="photo"></div>
              <div class="photo-button">
                <input type="file" hidden accept="image/*" (change)="onPhotoChange($event)" />
                <button mat-stroked-button type="button">
                  <mat-icon>edit</mat-icon>Modifier
                </button>
               </div>
          </label>          
        </div>

        <div class="descriptif-upload-wrapper">
            <mat-form-field appearance="fill">
              <mat-label>Nom de l'entreprise</mat-label>
              <input matInput formControlName="entreprise">
            </mat-form-field>

            <mat-form-field appearance="outline" class="comment-section">
              <mat-label>Descriptif</mat-label>
              <textarea matInput rows="4" formControlName="commentaires"></textarea>
            </mat-form-field>

          <div class="tool-section">
                  <!-- Bouton Prendre RDV -->
                  <div class="rdv-button">
                    <button mat-raised-button color="primary" (click)="onNewRdv()">
                      <mat-icon>calendar_today</mat-icon>
                      Prendre RDV
                    </button>
                  </div>

                  <!-- Bouton Upload -->
                  <div class="upload-button">
                    <label>
                      <input type="file" hidden accept=".pdf,.doc,.docx" (change)="onFileUpload($event, 'cv')" />
                    </label>
                    <button mat-raised-button color="accent" type="button" (click)="onFileUpload($event, 'cv')">
                      <mat-icon>attachment</mat-icon>
                      Joindre un document
                    </button>
                  </div>
                </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>


 <!-- Formulaire principal -->

  <form [formGroup]="form" class="mainForm">

    <mat-card class="form-card">
      <mat-card-title>Informations contact</mat-card-title>
      <mat-card-content>
        <mat-form-field appearance="fill">
          <mat-label>Nom</mat-label>
          <input matInput formControlName="nom">
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Prénom</mat-label>
          <input matInput formControlName="prenom">
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Téléphone</mat-label>
          <input matInput formControlName="tel">
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Portable</mat-label>
          <input matInput formControlName="portable">
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>E-mail</mat-label> 
          <input matInput formControlName="email">
        </mat-form-field>

      </mat-card-content>
    </mat-card>

    <mat-card class="form-card">
      <!-- Section localisation -->
      <mat-card-title>Localisation</mat-card-title>
      <mat-card-content>
        <mat-form-field appearance="fill">
          <mat-label>Adresse</mat-label>
          <input matInput formControlName="adresse">
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Ville</mat-label>
          <input matInput formControlName="ville">
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Zip code</mat-label>
          <input matInput formControlName="zipCode">
        </mat-form-field>
        <!--Carte-->
        <div class="map-wrapper">
          <div id="map" class="map-container"></div>

          <div class="coordinates-container">
            <mat-form-field appearance="fill" class="coordinate-field">
              <mat-label>Latitude</mat-label>
              <input matInput [(ngModel)]="latitude" (change)="updateMarker()" />
            </mat-form-field>

            <mat-form-field appearance="fill" class="coordinate-field">
              <mat-label>Longitude</mat-label>
              <input matInput [(ngModel)]="longitude" (change)="updateMarker()" />
            </mat-form-field>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Boutons -->
    <div class="button-container">
      <button mat-raised-button class="btn-cancel" (click)="onCancel()">Annuler</button>
      <button mat-raised-button class="btn-save" (click)="onSave()"><mat-icon>save</mat-icon>Enregistrer</button>
    </div>
  </form>

  <!-- Actions menées -->
 <mat-card class="history-card">
    <mat-card-title>Historique des actions</mat-card-title>
    <mat-card-content>
      <table mat-table [dataSource]="actions" class="mat-elevation-z2">

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let action">{{ action.date | date }}</td>
        </ng-container>

        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef>Type</th>
          <td mat-cell *matCellDef="let action">{{ action.type }}</td>
        </ng-container>

        <ng-container matColumnDef="details">
          <th mat-header-cell *matHeaderCellDef>Détails</th>
          <td mat-cell *matCellDef="let action">{{ action.details }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['date', 'type', 'details']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['date', 'type', 'details'];"></tr>

      </table>
    </mat-card-content>
  </mat-card>
    <div class="button-container">
      <button mat-raised-button class="btn-action" (click)="onExport()">
        <mat-icon>tab</mat-icon>Export
      </button>
    </div>

      <!-- Lien demandeur d'emploi -->
 <mat-card class="link-to-jobseeker">
    <mat-card-title>Lien entreprise demandeurs</mat-card-title>
    <mat-card-content>
      <table mat-table [dataSource]="linkToJobseeker" class="mat-elevation-z2">

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let action">{{ action.date | date }}</td>
        </ng-container>

        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef>Type</th>
          <td mat-cell *matCellDef="let action">{{ action.type }}</td>
        </ng-container>

        <ng-container matColumnDef="details">
          <th mat-header-cell *matHeaderCellDef>Détails</th>
          <td mat-cell *matCellDef="let action">{{ action.details }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['date', 'type', 'details']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['date', 'type', 'details'];"></tr>

      </table>
    </mat-card-content>
  </mat-card>

</div>